<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Call Me</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <link href="index.css" rel="stylesheet">
</head>

<body>
    <div class="language-switcher">
        <button id="langZh" class="language-btn active">ä¸­æ–‡</button>
        <button id="langEn" class="language-btn">English</button>
    </div>

    <div class="container">
        <div class="animation">
            <div class="phone"></div>
            <div class="ring"></div>
            <div class="ring" style="animation-delay: 1s"></div>
        </div>

        <h1 id="title">CALL ME</h1>
        <p class="subtitle" id="subtitle">æ¥æ‰¾æˆ‘ğŸŸ</p>

        <div class="bubble-container">
            <button class="btn bubble-btn" data-message="æ¥æ‰“ç†Š">æ¥æ‰“ç†ŠğŸ»</button>
            <button class="btn bubble-btn" data-message="å¿«ä¸Šçº¿">å¿«ä¸Šçº¿</button>
            <button class="btn bubble-btn" data-message="ç´§æ€¥æƒ…å†µ">ç´§æ€¥æƒ…å†µ</button>
            <button class="btn bubble-btn" data-message="æˆ‘æ¥é¢†å¥–å“">æˆ‘æ¥é¢†å¥–å“</button>
        </div>

        <div id="countdown" class="countdown">è¯·ç­‰å¾… <span id="seconds">60</span> ç§’åå†è¯•</div>
    </div>

    <div id="notification" class="notification"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const notifyBtns = document.querySelectorAll('.bubble-btn');
            const countdownEl = document.getElementById('countdown');
            const secondsEl = document.getElementById('seconds');
            const notificationEl = document.getElementById('notification');
            const langZhBtn = document.getElementById('langZh');
            const langEnBtn = document.getElementById('langEn');
            const titleEl = document.getElementById('title');
            const subtitleEl = document.getElementById('subtitle');
            
            const webhookUrl = 'https://trigger.macrodroid.com/16c8a69d-d6b2-40f4-9b93-5d76880f3527/webhook';
            
            // å¤šè¯­è¨€æ–‡æœ¬
            const translations = {
                zh: {
                    title: "CALL ME",
                    subtitle: "ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ï¼Œæˆ‘ä¼šç«‹å³æ”¶åˆ°é€šçŸ¥",
                    bubble1: "æ¥æ‰“ç†ŠğŸ»",
                    bubble2: "å¿«ä¸Šçº¿",
                    bubble3: "ç´§æ€¥æƒ…å†µ",
                    bubble4: "æˆ‘æ¥é¢†å ¡å’å¥–å“",
                    countdownText: "è¯·ç­‰å¾… {seconds} ç§’åå†è¯•",
                    successMsg: "å‘é€æˆåŠŸ!",
                    errorMsg: "å‘é€å¤±è´¥: {error}",
                    cooldownMsg: "è¯·ç­‰å¾… {seconds} ç§’åå†è¯•"
                },
                en: {
                    title: "CALL ME",
                    subtitle: "Click the button below to notify me immediately",
                    bubble1: "Let's hunt bears ğŸ»",
        bubble2: "Get online now",     
        bubble3: "Emergency",        
        bubble4: "I'll claim the fort rewards",  // "æˆ‘æ¥é¢†å ¡å’å¥–å“"
                    countdownText: "Please wait {seconds} seconds to try again",
                    successMsg: "Sent successfully!",
                    errorMsg: "Failed to send: {error}",
                    cooldownMsg: "Please wait {seconds} seconds to try again"
                }
            };
            
            let currentLang = 'zh';
            let canClick = true;
            let countdownInterval;
            let isRequestPending = false;
            
            // ä»æœ¬åœ°å­˜å‚¨è·å–å†·å´çŠ¶æ€
            const lastClickTime = localStorage.getItem('lastClickTime');
            if (lastClickTime) {
                const remainingTime = Math.max(0, 60 - Math.floor((Date.now() - lastClickTime) / 1000));
                if (remainingTime > 0) {
                    startCountdown(remainingTime);
                }
            }
            
            // æ›´æ–°è¯­è¨€
            function updateLanguage(lang) {
                currentLang = lang;
                const t = translations[lang];
                
                titleEl.textContent = t.title;
                subtitleEl.textContent = t.subtitle;
                
                const bubbles = document.querySelectorAll('.bubble-btn');
                bubbles[0].textContent = t.bubble1;
                bubbles[1].textContent = t.bubble2;
                bubbles[2].textContent = t.bubble3;
                bubbles[3].textContent = t.bubble4;
                
                // æ›´æ–°æŒ‰é’®æ¿€æ´»çŠ¶æ€
                langZhBtn.classList.toggle('active', lang === 'zh');
                langEnBtn.classList.toggle('active', lang === 'en');
            }
            
            function showNotification(message, isSuccess = true) {
                notificationEl.textContent = message;
                notificationEl.className = 'notification ' + (isSuccess ? 'success' : 'error');
                notificationEl.classList.add('show');
                
                setTimeout(() => {
                    notificationEl.classList.remove('show');
                }, 3000);
            }
            
            function startCountdown(initialSeconds = 60) {
                let seconds = initialSeconds;
                canClick = false;
                notifyBtns.forEach(btn => btn.disabled = true);
                countdownEl.classList.add('show');
                
                const t = translations[currentLang];
                secondsEl.textContent = seconds;
                countdownEl.innerHTML = t.countdownText.replace('{seconds}', `<span id="seconds">${seconds}</span>`);
                
                countdownInterval = setInterval(() => {
                    seconds--;
                    document.getElementById('seconds').textContent = seconds;
                    
                    if (seconds <= 0) {
                        clearInterval(countdownInterval);
                        notifyBtns.forEach(btn => btn.disabled = false);
                        countdownEl.classList.remove('show');
                        canClick = true;
                        localStorage.removeItem('lastClickTime');
                    }
                }, 1000);
            }
            
            // è¯­è¨€åˆ‡æ¢
            langZhBtn.addEventListener('click', () => updateLanguage('zh'));
            langEnBtn.addEventListener('click', () => updateLanguage('en'));
            
            // æ°”æ³¡æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            notifyBtns.forEach(btn => {
                btn.addEventListener('click', async function() {
                    if (!canClick || isRequestPending) return;
                    
                    const message = this.dataset.message;
                    canClick = false;
                    isRequestPending = true;
                    localStorage.setItem('lastClickTime', Date.now());
                    startCountdown();
                    
                    try {
                        const response = await fetch(
                            `${webhookUrl}?message=${encodeURIComponent(message)}`, 
                            { method: 'GET' }
                        );
                        
                        if (!response.ok) throw new Error(`HTTPé”™è¯¯: ${response.status}`);
                        
                        const t = translations[currentLang];
                        showNotification(t.successMsg);
                    } catch (error) {
                        const t = translations[currentLang];
                        showNotification(t.errorMsg.replace('{error}', error.message), false);
                    } finally {
                        isRequestPending = false;
                    }
                });
            });
        });
    </script>
</body>

</html>